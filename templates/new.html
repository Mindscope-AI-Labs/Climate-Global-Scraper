<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OpenCurrent</title>
  <link href="/static/css/styles.css" rel="stylesheet" />
  <!-- Add new styles for the chat interface -->
  <style>
    .chat-container { display: none; margin-top: 24px; }
    .chat-window {
      height: 400px; max-height: 60vh; overflow-y: auto;
      background: var(--input); padding: 16px; border-radius: 8px;
      border: 1px solid var(--border-color); margin-bottom: 16px;
      display: flex; flex-direction: column; gap: 12px;
    }
    .chat-message { padding: 10px 14px; border-radius: 12px; max-width: 80%; line-height: 1.6; }
    .user-message { background: var(--accent); color: white; align-self: flex-end; }
    .ai-message { background: var(--panel); color: #e6eef6; align-self: flex-start; }
    .ingest-status { margin-top: 16px; padding: 12px; border-radius: 8px; background: var(--input); display: none; }
  </style>
</head>
<body>
  <div class="page">
    <nav class="sidebar" id="sidebar">
      <!-- ... (your existing sidebar header) ... -->
      <div class="sidebar-header">
        <div class="brand"><img src="/static/images/logo.png" alt="OpenCurrent Logo" class="logo" /><span class="brand-name">OpenCurrent</span></div>
        <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar"><svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path></svg></button>
      </div>
      <div class="sidebar-content">
        <div class="nav-section">
          <h3 class="nav-section-title">Main</h3>
          <ul class="nav-menu">
            <li><a href="#" class="nav-item active" data-section="search">
              <!-- Search Icon SVG -->
              <span class="nav-icon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></span>
              <span class="nav-text">Search</span>
            </a></li>
            <!-- New Chat Navigation Item -->
            <li><a href="#" class="nav-item" data-section="chat">
              <span class="nav-icon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 01-2.555-.337A5.972 5.972 0 015.41 20.97a5.969 5.969 0 01-.474-.065 4.48 4.48 0 00.978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25z" /></svg></span>
              <span class="nav-text">Chat with Site</span>
            </a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="main-content">
      <header class="topbar"><!-- ... (your existing topbar) ... --></header>
      <main class="content">
        <!-- Search Section (no changes) -->
        <section class="content-section active" id="search-section"><!-- ... --></section>
        
        <!-- New Chat Section -->
        <section class="content-section" id="chat-section">
          <div class="section-header">
            <h2>Chat with a Website</h2>
            <p>Enter a URL to ingest its content, then ask questions to get AI-powered answers based on that content.</p>
          </div>

          <div class="ingest-container" id="ingestContainer" style="max-width: 700px;">
            <form id="ingestForm" class="card">
              <div class="form-group">
                <label for="ingestUrl">URL to Ingest and Chat With</label>
                <input id="ingestUrl" class="input" placeholder="https://example.com/about-us" required />
              </div>
              <div class="actions">
                <button type="submit" class="btn btn-primary">Ingest Site</button>
              </div>
            </form>
            <div id="ingestStatus" class="ingest-status"></div>
          </div>

          <div class="chat-container" id="chatContainer">
            <div id="chatWindow" class="chat-window">
              <div class="ai-message">Hello! Once the site is ingested, ask me anything about its content.</div>
            </div>
            <form id="chatForm" class="card">
              <div class="form-group" style="margin-bottom: 0;">
                <input id="chatInput" class="input" placeholder="Ask a question about the website..." required autocomplete="off">
                <!-- A submit button could go here, but Enter key is primary -->
              </div>
            </form>
          </div>
        </section>
      </main>
      <footer class="footer"><!-- ... (your existing footer) ... --></footer>
    </div>
  </div>
  <!-- ... (your existing modals) ... -->
  <script src="/static/js/app.js"></script>
</body>
</html>